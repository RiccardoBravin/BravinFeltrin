title eMSP user login

actor registered User
participant MainActivity
participant SigningActivity
participant eMSP_RegistrationService
database Users_DBMS


activate MainActivity

registered User->MainActivity:Open APP

MainActivity->MainActivity:isLogged()

activate MainActivity
MainActivity->>SigningActivity:StartSigningActivity
deactivate MainActivity
deactivate MainActivity

activate SigningActivity
SigningActivity-->registered User: ShowInterface



registered User->SigningActivity:Click login button

registered User<--SigningActivity:ShowLoginForm


registered User->SigningActivity:Submit data

SigningActivity->SigningActivity:ValidateInput()

alt isValid

	SigningActivity->eMSP_RegistrationService:Login(Data)
	
	activate eMSP_RegistrationService
	eMSP_RegistrationService->Users_DBMS:checkUser(Data)
	activate Users_DBMS


	alt isRegistered

	Users_DBMS-->eMSP_RegistrationService:isRegistered
    deactivate Users_DBMS
    eMSP_RegistrationService-->SigningActivity:OK
    deactivate eMSP_RegistrationService
    SigningActivity-->registered User:Successfull login
    
    SigningActivity->MainActivity:StartMainActivity
    deactivate SigningActivity
    activate MainActivity
    MainActivity-->registered User:Show
    space
    deactivate MainActivity
    
   

	else User already registered
    activate Users_DBMS
    Users_DBMS-->eMSP_RegistrationService:isNotRegistered
	deactivate Users_DBMS
    activate eMSP_RegistrationService
    eMSP_RegistrationService-->SigningActivity:Failed
    deactivate eMSP_RegistrationService
    activate SigningActivity
    SigningActivity-->registered User:Failed
    space
    deactivate SigningActivity
    
    
	end
else notValid

activate SigningActivity
SigningActivity-->registered User:Invalid data
space 
deactivate SigningActivity
end 