title Manually set battery target

actor CPO Employee
participant CPMS_graphics
participant CPMS_powerManagerService
participant batteryPackAPI


linear

activate CPMS_graphics
activate batteryPackAPI

	CPO Employee->CPMS_graphics:select battery control 
    
    CPMS_graphics -> CPMS_powerManagerService: requestBatteryInfo()
    activate CPMS_powerManagerService
    CPMS_powerManagerService->batteryPackAPI: requestInfo()
    
    batteryPackAPI-->CPMS_powerManagerService:BatteryInfo
    CPMS_powerManagerService-->CPMS_graphics: BatteryInfo
    deactivate CPMS_powerManagerService
    CPMS_graphics-->CPO Employee:show Battery info 
    
    CPO Employee->CPMS_graphics:select new battery target
    CPMS_graphics->CPMS_powerManagerService:newBatteryTarget(level)
    activate CPMS_powerManagerService
    
    CPMS_powerManagerService->CPMS_powerManagerService:startBatteryMonitoring
    activate CPMS_powerManagerService
    
    
    
    CPMS_powerManagerService-->CPMS_graphics:NewTargetSet
    CPMS_graphics-->CPO Employee:new target set confirmation 
    
    loop periodic call
    	CPMS_powerManagerService->batteryPackAPI: requestInfo()
    
    	batteryPackAPI-->CPMS_powerManagerService:BatteryInfo
    
    	alt Battery level > target
        	CPMS_powerManagerService->batteryPackAPI:SetDischarge()
        	batteryPackAPI-->CPMS_powerManagerService:OK
        else Battery level > target
        	CPMS_powerManagerService->batteryPackAPI:SetCharge()
        	batteryPackAPI-->CPMS_powerManagerService:OK
        end
    end
    
deactivate CPMS_powerManagerService
deactivate CPMS_powerManagerService
deactivate batteryPackAPI
    

